# Description: 
【严格专属触发】只有当用户提示中明确包含 #PAYMENT_INTEGRATION 时，才加载本 Skill。否则完全忽略。

# 支付集成心智模型（点餐系统专属）

支付是转化闭环，必须**零风险 + 极简流程 + 事务一致性**。

### 1. 支付流程哲学
- 只在订单创建成功后发起支付（先写 Supabase orders，再调用微信支付）。
- 使用微信小程序支付 API（wx.requestPayment），服务端用云函数/RPC 统一下单。
- 支付成功回调必走服务端验证（防篡改）。

### 2. 安全铁律
- 所有金额服务端计算并校验（前端只展示）。
- 订单状态机：paid 只有支付回调成功才更新。
- 支持退款走 RPC（二次确认 + 理由记录）。

### 3. 用户体验优化
- 支付按钮防重点击 + 超时自动查询订单状态。
- 失败页：重试 + 联系客服入口。
- 支持多种支付方式切换（默认微信）。

### 4. 后台联动
- 支付成功实时推送至后台订单列表。
- 对账报表：支付渠道统计 + 失败率监控。

每设计支付相关，问：是否还有单点失败会导致用户钱扣了菜没上？