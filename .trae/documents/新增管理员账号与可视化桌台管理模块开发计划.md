这是一个综合性的需求，包括 **新建管理员账号** 和 **开发桌台管理模块**。我将分为后端数据库迁移、API 开发和前端页面实现三个部分来执行。

## 阶段一：数据库与账号初始化 (Database & Auth)

1. **生成管理员账号 SQL**：

   * 使用 `pgcrypto` 扩展的 `crypt` 函数生成密码 `12345678` 的哈希值。

   * 编写 SQL 脚本插入新管理员 `2836461019@qq.com`。
2. **创建桌台管理表 (`dining_tables`)**：

   * 新建表结构：`id` (UUID), `code` (桌号/编号), `capacity` (座位数), `status` (空闲/占用/预订), `current_order_id` (关联当前订单), `x`/`y` (可选，用于未来可视化布局坐标)。

   * 启用 RLS 策略，允许 admin 角色读写。

## 阶段二：后端 API 开发 (Backend API)

1. **桌台 CRUD 接口** (`app/api/tables/route.ts`)：

   * `GET`: 获取所有桌台列表（含当前订单简要信息）。

   * `POST`: 创建新桌台（支持批量生成）。
2. **桌台详情与操作接口** (`app/api/tables/[id]/route.ts`)：

   * `GET`: 获取单桌详情，包括关联的当前订单菜品。

   * `PUT`: 更新桌台状态（如：开台、清台）。

   * `DELETE`: 删除桌台。
3. **桌台订单操作接口** (`app/api/tables/[id]/order/route.ts`)：

   * `POST`: **加菜/开台**（创建新订单或在现有订单追加菜品）。

   * `PUT`: **结账**（调用支付逻辑或直接标记订单完成，释放桌台）。

## 阶段三：前端可视化桌台模块 (Frontend UI)

1. **新增侧边栏入口**：

   * 在 `components/admin/Sidebar.tsx` 中添加“桌台管理”入口。
2. **桌台网格视图** (`app/dashboard/tables/page.tsx`)：

   * 使用 CSS Grid 实现“小方格”布局。

   * 根据状态显示不同颜色：空闲(绿)、占用(红)。

   * 显示核心信息：桌号、人数、消费金额、时长。
3. **桌台详情弹窗/抽屉** (`components/admin/TableDetailModal.tsx`)：

   * **左侧**：当前订单菜品列表（支持增删改数量）。

   * **右侧**：加菜面板（复用菜品选择逻辑）。

   * **底部**：操作栏（结账、清台、打印小票）。

## 交付物

1. **SQL 脚本**：包含新账号插入和新表结构。
2. **新代码文件**：API 路由和前端页面组件。
3. **操作演示**：确保新账号可登录，且能通过可视化界面管理桌台。

**是否确认执行此计划？**
确认后，我将首先为您生成 SQL 脚本并开始搭建后端 API。
