# é¡¹ç›®æ€»è§ˆ

## ğŸ“– é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Next.js 14** å’Œ **Supabase** æ„å»ºçš„ç°ä»£åŒ–é¤é¥®åå°ç®¡ç†ç³»ç»Ÿï¼Œç”¨äºç®¡ç†é¤é¥®å°ç¨‹åºçš„èœå“ã€è®¢å•ã€ç”¨æˆ·ç­‰æ•°æ®ã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **ç°ä»£åŒ–æŠ€æœ¯æ ˆ**: Next.js 14 App Router + TypeScript + Tailwind CSS
- âœ… **Serverless æ¶æ„**: API Routes å®ç°åç«¯é€»è¾‘ï¼Œæ— éœ€ç‹¬ç«‹æœåŠ¡å™¨
- âœ… **å®æ—¶æ•°æ®åº“**: Supabase PostgreSQLï¼Œæ”¯æŒå®æ—¶è®¢é˜…
- âœ… **å“åº”å¼è®¾è®¡**: é€‚é…æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯
- âœ… **ç±»å‹å®‰å…¨**: å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
- âœ… **æ˜“äºéƒ¨ç½²**: ä¸€é”®éƒ¨ç½²åˆ° Vercel

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Next.js 14 App Router       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  React 18 + TypeScript + Tailwind   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Client Components           â”‚
â”‚  (äº¤äº’å¼é¡µé¢ã€è¡¨å•ã€å›¾è¡¨ç­‰)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åç«¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         API Routes (Serverless)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  /api/auth     - è®¤è¯ç›¸å…³           â”‚
â”‚  /api/dishes   - èœå“ç®¡ç†           â”‚
â”‚  /api/orders   - è®¢å•ç®¡ç†           â”‚
â”‚  /api/users    - ç”¨æˆ·ç®¡ç†           â”‚
â”‚  /api/analytics - æ•°æ®ç»Ÿè®¡          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Supabase Client Library        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Supabase PostgreSQL Database     â”‚
â”‚  (16 å¼ è¡¨ + ç´¢å¼• + è§¦å‘å™¨ + RLS)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®åº“æ¶æ„

```
æ ¸å¿ƒä¸šåŠ¡è¡¨:
â”œâ”€â”€ dishes (èœå“è¡¨)
â”œâ”€â”€ orders (è®¢å•è¡¨)
â”œâ”€â”€ users (ç”¨æˆ·è¡¨)
â”œâ”€â”€ admins (ç®¡ç†å‘˜è¡¨)

è¥é”€åŠŸèƒ½è¡¨:
â”œâ”€â”€ coupons (ä¼˜æƒ åˆ¸æ¨¡æ¿)
â”œâ”€â”€ user_coupons (ç”¨æˆ·ä¼˜æƒ åˆ¸)
â”œâ”€â”€ group_activities (æ‹¼å›¢æ´»åŠ¨)
â”œâ”€â”€ group_orders (æ‹¼å›¢è®¢å•)
â”œâ”€â”€ share_records (åˆ†äº«è®°å½•)
â”œâ”€â”€ invite_records (é‚€è¯·è®°å½•)

æœåŠ¡åŠŸèƒ½è¡¨:
â”œâ”€â”€ queue (æ’é˜Ÿå–å·)
â”œâ”€â”€ reservations (é¢„çº¦)
â”œâ”€â”€ addresses (æ”¶è´§åœ°å€)

å…¶ä»–è¡¨:
â”œâ”€â”€ feedback (åé¦ˆ)
â”œâ”€â”€ reviews (è¯„ä»·)
â””â”€â”€ settings (ç³»ç»Ÿè®¾ç½®)
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
restaurant-admin-nextjs/
â”‚
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ api/                      # API Routes (åç«¯)
â”‚   â”‚   â”œâ”€â”€ auth/                 # è®¤è¯ API
â”‚   â”‚   â”‚   â””â”€â”€ login/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts      # POST /api/auth/login
â”‚   â”‚   â”œâ”€â”€ dishes/               # èœå“ API
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts          # GET/POST /api/dishes
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts      # GET/PUT/DELETE /api/dishes/:id
â”‚   â”‚   â”œâ”€â”€ orders/               # è®¢å• API
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts          # GET /api/orders
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â””â”€â”€ route.ts      # GET/PUT /api/orders/:id
â”‚   â”‚   â”œâ”€â”€ users/                # ç”¨æˆ· API
â”‚   â”‚   â”‚   â””â”€â”€ route.ts          # GET /api/users
â”‚   â”‚   â””â”€â”€ analytics/            # ç»Ÿè®¡ API
â”‚   â”‚       â””â”€â”€ route.ts          # GET /api/analytics
â”‚   â”‚
â”‚   â”œâ”€â”€ dashboard/                # ç®¡ç†åå°é¡µé¢ (å‰ç«¯)
â”‚   â”‚   â”œâ”€â”€ layout.tsx            # åå°å¸ƒå±€ï¼ˆä¾§è¾¹æ +å¯¼èˆªï¼‰
â”‚   â”‚   â”œâ”€â”€ page.tsx              # ä»ªè¡¨æ¿é¦–é¡µ
â”‚   â”‚   â”œâ”€â”€ dishes/               # èœå“ç®¡ç†é¡µ
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â”œâ”€â”€ orders/               # è®¢å•ç®¡ç†é¡µ
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚   â””â”€â”€ users/                # ç”¨æˆ·ç®¡ç†é¡µ
â”‚   â”‚       â””â”€â”€ page.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ login/                    # ç™»å½•é¡µ
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ layout.tsx                # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ page.tsx                  # é¦–é¡µï¼ˆé‡å®šå‘ï¼‰
â”‚   â””â”€â”€ globals.css               # å…¨å±€æ ·å¼
â”‚
â”œâ”€â”€ lib/                          # å·¥å…·åº“
â”‚   â”œâ”€â”€ supabase.ts               # Supabase å®¢æˆ·ç«¯é…ç½®
â”‚   â””â”€â”€ types.ts                  # TypeScript ç±»å‹å®šä¹‰
â”‚
â”œâ”€â”€ supabase/                     # Supabase é…ç½®
â”‚   â””â”€â”€ migrations/               # æ•°æ®åº“è¿ç§»æ–‡ä»¶
â”‚       â””â”€â”€ 001_initial_schema.sql  # åˆå§‹åŒ–æ•°æ®åº“ç»“æ„
â”‚
â”œâ”€â”€ package.json                  # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ tsconfig.json                 # TypeScript é…ç½®
â”œâ”€â”€ tailwind.config.ts            # Tailwind CSS é…ç½®
â”œâ”€â”€ next.config.js                # Next.js é…ç½®
â”œâ”€â”€ .env.local.example            # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .gitignore                    # Git å¿½ç•¥æ–‡ä»¶
â”‚
â””â”€â”€ æ–‡æ¡£/
    â”œâ”€â”€ README.md                 # é¡¹ç›®è¯´æ˜
    â”œâ”€â”€ QUICKSTART.md             # å¿«é€Ÿå¼€å§‹
    â”œâ”€â”€ DEPLOYMENT.md             # éƒ¨ç½²æŒ‡å—
    â””â”€â”€ PROJECT_OVERVIEW.md       # é¡¹ç›®æ€»è§ˆï¼ˆæœ¬æ–‡ä»¶ï¼‰
```

## ğŸ”„ æ•°æ®æµ

### 1. ç”¨æˆ·ç™»å½•æµç¨‹

```
ç”¨æˆ·è¾“å…¥é‚®ç®±å¯†ç 
    â†“
å‰ç«¯: app/login/page.tsx
    â†“
POST /api/auth/login
    â†“
åç«¯: app/api/auth/login/route.ts
    â†“
Supabase: æŸ¥è¯¢ admins è¡¨
    â†“
éªŒè¯å¯†ç 
    â†“
è¿”å›ç®¡ç†å‘˜ä¿¡æ¯
    â†“
å‰ç«¯: è·³è½¬åˆ° /dashboard
```

### 2. è·å–èœå“åˆ—è¡¨æµç¨‹

```
ç”¨æˆ·è®¿é—®èœå“ç®¡ç†é¡µ
    â†“
å‰ç«¯: app/dashboard/dishes/page.tsx
    â†“
useEffect è§¦å‘ fetchDishes()
    â†“
GET /api/dishes?category=main&status=on_sale
    â†“
åç«¯: app/api/dishes/route.ts
    â†“
Supabase: SELECT * FROM dishes WHERE...
    â†“
è¿”å›èœå“æ•°æ® + åˆ†é¡µä¿¡æ¯
    â†“
å‰ç«¯: æ›´æ–° stateï¼Œæ¸²æŸ“è¡¨æ ¼
```

### 3. æ›´æ–°è®¢å•çŠ¶æ€æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»"ç¡®è®¤æ”¯ä»˜"æŒ‰é’®
    â†“
å‰ç«¯: app/dashboard/orders/page.tsx
    â†“
handleUpdateStatus(orderId, 'paid')
    â†“
PUT /api/orders/:id
    â†“
åç«¯: app/api/orders/[id]/route.ts
    â†“
Supabase: UPDATE orders SET status='paid' WHERE id=...
    â†“
è¿”å›æ›´æ–°åçš„è®¢å•æ•°æ®
    â†“
å‰ç«¯: åˆ·æ–°è®¢å•åˆ—è¡¨
```

## ğŸ¨ UI ç»„ä»¶

### å¸ƒå±€ç»„ä»¶

- **DashboardLayout**: ç®¡ç†åå°ä¸»å¸ƒå±€ï¼ˆä¾§è¾¹æ  + å†…å®¹åŒºï¼‰
- **Sidebar**: å·¦ä¾§å¯¼èˆªèœå•
- **Header**: é¡¶éƒ¨å¯¼èˆªæ ï¼ˆå¯æ‰©å±•ï¼‰

### é¡µé¢ç»„ä»¶

- **LoginPage**: ç™»å½•é¡µé¢
- **DashboardPage**: ä»ªè¡¨æ¿é¦–é¡µï¼ˆç»Ÿè®¡å¡ç‰‡ï¼‰
- **DishesPage**: èœå“ç®¡ç†é¡µï¼ˆè¡¨æ ¼ + ç­›é€‰ï¼‰
- **OrdersPage**: è®¢å•ç®¡ç†é¡µï¼ˆå¡ç‰‡åˆ—è¡¨ + çŠ¶æ€æ›´æ–°ï¼‰
- **UsersPage**: ç”¨æˆ·ç®¡ç†é¡µï¼ˆè¡¨æ ¼ + ä¼šå‘˜ç­‰çº§ï¼‰

### UI å…ƒç´ 

- **ç»Ÿè®¡å¡ç‰‡**: æ˜¾ç¤ºå…³é”®æŒ‡æ ‡ï¼ˆè¥æ”¶ã€è®¢å•æ•°ç­‰ï¼‰
- **æ•°æ®è¡¨æ ¼**: å±•ç¤ºåˆ—è¡¨æ•°æ®ï¼ˆèœå“ã€ç”¨æˆ·ç­‰ï¼‰
- **ç­›é€‰å™¨**: ä¸‹æ‹‰é€‰æ‹©æ¡†ï¼ˆåˆ†ç±»ã€çŠ¶æ€ç­‰ï¼‰
- **æ“ä½œæŒ‰é’®**: ç¼–è¾‘ã€åˆ é™¤ã€çŠ¶æ€æ›´æ–°ç­‰

## ğŸ” å®‰å…¨æœºåˆ¶

### 1. Row Level Security (RLS)

Supabase å¯ç”¨äº† RLSï¼Œç¡®ä¿æ•°æ®è®¿é—®å®‰å…¨ï¼š

```sql
-- åªæœ‰è®¤è¯ç”¨æˆ·å¯ä»¥è®¿é—®æ•°æ®
CREATE POLICY "Admins can do everything" 
ON dishes FOR ALL 
USING (auth.role() = 'authenticated');
```

### 2. API è®¤è¯ï¼ˆå¾…å®ç°ï¼‰

å»ºè®®å®ç° JWT token è®¤è¯ï¼š

```typescript
// ç”Ÿæˆ token
const token = jwt.sign({ adminId }, JWT_SECRET, { expiresIn: '7d' })

// éªŒè¯ token
const decoded = jwt.verify(token, JWT_SECRET)
```

### 3. å¯†ç åŠ å¯†ï¼ˆå¾…å®ç°ï¼‰

ä½¿ç”¨ bcrypt åŠ å¯†å¯†ç ï¼š

```typescript
// æ³¨å†Œæ—¶
const hashedPassword = await bcrypt.hash(password, 10)

// ç™»å½•æ—¶
const isValid = await bcrypt.compare(password, hashedPassword)
```

### 4. ç¯å¢ƒå˜é‡ä¿æŠ¤

æ•æ„Ÿä¿¡æ¯å­˜å‚¨åœ¨ `.env.local`ï¼Œä¸æäº¤åˆ° Gitã€‚

## ğŸ“Š æ•°æ®ç»Ÿè®¡

### å®æ—¶ç»Ÿè®¡æŒ‡æ ‡

- **ä»Šæ—¥è¥æ”¶**: ä»Šå¤©å·²å®Œæˆè®¢å•çš„æ€»é‡‘é¢
- **ä»Šæ—¥è®¢å•æ•°**: ä»Šå¤©çš„è®¢å•æ•°é‡
- **æ€»ç”¨æˆ·æ•°**: æ³¨å†Œç”¨æˆ·æ€»æ•°
- **å¾…å¤„ç†è®¢å•**: çŠ¶æ€ä¸º pending çš„è®¢å•æ•°

### ç»Ÿè®¡ API

```typescript
GET /api/analytics

Response:
{
  "todayRevenue": 1234.56,
  "todayOrderCount": 45,
  "totalUsers": 1000,
  "totalOrders": 5000,
  "totalRevenue": 123456.78,
  "pendingOrders": 10
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### 1. æ•°æ®åº“ä¼˜åŒ–

- âœ… åˆ›å»ºç´¢å¼•ï¼ˆcategory, status, created_at ç­‰ï¼‰
- âœ… ä½¿ç”¨è§¦å‘å™¨è‡ªåŠ¨æ›´æ–° updated_at
- âœ… åˆ†é¡µæŸ¥è¯¢ï¼ˆlimit + offsetï¼‰

### 2. å‰ç«¯ä¼˜åŒ–

- âœ… ä½¿ç”¨ React 18 å¹¶å‘ç‰¹æ€§
- âœ… å®¢æˆ·ç«¯ç»„ä»¶æŒ‰éœ€åŠ è½½
- â³ å›¾ç‰‡æ‡’åŠ è½½ï¼ˆå¾…å®ç°ï¼‰
- â³ è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§åˆ—è¡¨ï¼‰

### 3. API ä¼˜åŒ–

- âœ… Serverless å‡½æ•°ï¼ˆè‡ªåŠ¨æ‰©å±•ï¼‰
- â³ API å“åº”ç¼“å­˜
- â³ æ•°æ®é¢„å–

## ğŸ”® æœªæ¥è§„åˆ’

### çŸ­æœŸç›®æ ‡ï¼ˆ1-2å‘¨ï¼‰

- [ ] å®Œå–„ä¼˜æƒ åˆ¸ç®¡ç†åŠŸèƒ½
- [ ] æ·»åŠ åé¦ˆç®¡ç†é¡µé¢
- [ ] å®ç°ç³»ç»Ÿè®¾ç½®åŠŸèƒ½
- [ ] æ·»åŠ æ•°æ®å¯è§†åŒ–å›¾è¡¨
- [ ] å®ç°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½

### ä¸­æœŸç›®æ ‡ï¼ˆ1-2æœˆï¼‰

- [ ] å®ç° JWT è®¤è¯
- [ ] æ·»åŠ æƒé™ç®¡ç†ç³»ç»Ÿ
- [ ] å®ç°æ‹¼å›¢æ´»åŠ¨ç®¡ç†
- [ ] æ·»åŠ æ•°æ®å¯¼å‡ºåŠŸèƒ½
- [ ] å®ç°å®æ—¶é€šçŸ¥

### é•¿æœŸç›®æ ‡ï¼ˆ3-6æœˆï¼‰

- [ ] å¤šç§Ÿæˆ·æ”¯æŒ
- [ ] ç§»åŠ¨ç«¯ App
- [ ] æ•°æ®åˆ†ææŠ¥è¡¨
- [ ] AI æ™ºèƒ½æ¨è
- [ ] å¾®æœåŠ¡æ¶æ„

## ğŸ“ å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼

- ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
- éµå¾ª ESLint è§„åˆ™
- ä½¿ç”¨ Prettier æ ¼å¼åŒ–ä»£ç 
- ç»„ä»¶ä½¿ç”¨å‡½æ•°å¼å†™æ³•

### å‘½åè§„èŒƒ

- æ–‡ä»¶å: kebab-case (ä¾‹: `dish-detail.tsx`)
- ç»„ä»¶å: PascalCase (ä¾‹: `DishDetail`)
- å‡½æ•°å: camelCase (ä¾‹: `fetchDishes`)
- å¸¸é‡å: UPPER_SNAKE_CASE (ä¾‹: `API_BASE_URL`)

### Git æäº¤è§„èŒƒ

```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤ bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·ç›¸å…³
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'feat: Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ“ è”ç³»æ–¹å¼

å¦‚éœ€æŠ€æœ¯æ”¯æŒæˆ–å®šåˆ¶å¼€å‘ï¼Œè¯·è”ç³»å¼€å‘è€…ã€‚

---

**æœ€åæ›´æ–°**: 2025-01-18
